unit udmPedidoVenda;

interface

uses
  System.SysUtils, System.Classes, udmBaseCadastro, uMethods, udmConexao,
  uClasses, Rest.Json;

type
  TdmPedidoVenda = class(TdmBaseCadastro)
  private
    FPedido: TPedido;
    { Private declarations }
  public
    { Public declarations }
    function CarregarDadosCliente(ID: Integer): TDadosCliente;
    property Pedido: TPedido read FPedido write FPedido;
    function SalvarCadastro: Boolean;override;
  end;

var
  dmPedidoVenda: TdmPedidoVenda;

implementation

{%CLASSGROUP 'Vcl.Controls.TControl'}

{$R *.dfm}

{ TdmPedidoVenda }

function TdmPedidoVenda.CarregarDadosCliente(ID: Integer): TDadosCliente;
var
  Methods: TdmCadPedidoVendaClient;
begin
  Methods := TdmCadPedidoVendaClient.Create(dmConexao.rConexao);
  try
    Result := TJson.JsonToObject<TDadosCliente>(Methods.RetornaDadosCliente(ID));
  finally
    Methods.Free;
  end;
end;

function TdmPedidoVenda.SalvarCadastro: Boolean;
begin
  JsonSalvar := TJson.ObjectToJsonString(Pedido);
  inherited;
end;

end.
